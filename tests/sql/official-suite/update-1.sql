-- original: update.test
-- credit:   http://www.sqlite.org/src/tree?ci=trunk&name=test

CREATE TABLE test1(f1 int,f2 int)
;SELECT * FROM test1 ORDER BY f1
;UPDATE test1 SET f2=f2*3
;SELECT count(*) FROM test1
;SELECT * FROM test1 ORDER BY f1
;PRAGMA count_changes=on
;UPDATE test1 SET f2=f2/3 WHERE f1<=5
;SELECT * FROM test1 ORDER BY f1
;UPDATE test1 SET f2=f2/3 WHERE f1>5
;SELECT * FROM test1 ORDER BY f1
;UPDATE test1 SET F2=f1, F1=f2
;SELECT * FROM test1 ORDER BY F1
;PRAGMA count_changes=off
;UPDATE test1 SET F2=f1, F1=f2
;SELECT * FROM test1 ORDER BY F1
;DELETE FROM test1 WHERE f1<=5;
    INSERT INTO test1(f1,f2) VALUES(8,88);
    INSERT INTO test1(f1,f2) VALUES(8,888);
    INSERT INTO test1(f1,f2) VALUES(77,128);
    INSERT INTO test1(f1,f2) VALUES(777,128)
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f2=f2+1 WHERE f1==8
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f2=f2-1 WHERE f1==8 and f2>800
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f2=f2-1 WHERE f1==8 and f2<800
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f1=f1+1 WHERE f2==128
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f1=f1-1 WHERE f1>100 and f2==128
;SELECT * FROM test1 ORDER BY f1,f2
;PRAGMA count_changes=on;
    UPDATE test1 SET f1=f1-1 WHERE f1<=100 and f2==128
;PRAGMA count_changes=off;
    SELECT * FROM test1 ORDER BY f1,f2
;CREATE INDEX idx1 ON test1(f1)
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f2=f2+1 WHERE f1==8
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f2=f2-1 WHERE f1==8 and f2>800
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f2=f2-1 WHERE f1==8 and f2<800
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f1=f1+1 WHERE f2==128
;SELECT * FROM test1 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==78 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==778 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==8 ORDER BY f1,f2
;UPDATE test1 SET f1=f1-1 WHERE f1>100 and f2==128
;SELECT * FROM test1 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==78 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==778 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==777 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==8 ORDER BY f1,f2
;PRAGMA count_changes=on;
    UPDATE test1 SET f1=f1-1 WHERE f1<=100 and f2==128
;PRAGMA count_changes=off;
    SELECT * FROM test1 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==77 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==778 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==777 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==8 ORDER BY f1,f2
;PRAGMA synchronous=FULL
;DROP INDEX idx1
;CREATE INDEX idx1 ON test1(f2)
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f2=f2+1 WHERE f1==8
;SELECT * FROM test1 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==8 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f2==89 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==88 ORDER BY f1,f2
;UPDATE test1 SET f2=f2-1 WHERE f1==8 and f2>800
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f2=f2-1 WHERE f1==8 and f2<800
;SELECT * FROM test1 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==8 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f2==89 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f2==88 ORDER BY f1,f2
;UPDATE test1 SET f1=f1+1 WHERE f2==128
;SELECT * FROM test1 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==78 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==778 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==8 ORDER BY f1,f2
;UPDATE test1 SET f1=f1-1 WHERE f1>100 and f2==128
;SELECT * FROM test1 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==78 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==778 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==777 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==8 ORDER BY f1,f2
;UPDATE test1 SET f1=f1-1 WHERE f1<=100 and f2==128
;SELECT * FROM test1 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==77 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==778 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==777 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==8 ORDER BY f1,f2
;CREATE INDEX idx2 ON test1(f2)
;CREATE INDEX idx3 ON test1(f1,f2)
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f2=f2+1 WHERE f1==8
;SELECT * FROM test1 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==8 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f2==89 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==88 ORDER BY f1,f2
;UPDATE test1 SET f2=f2-1 WHERE f1==8 and f2>800
;SELECT * FROM test1 ORDER BY f1,f2
;UPDATE test1 SET f2=f2-1 WHERE f1==8 and f2<800
;SELECT * FROM test1 ORDER BY f1,f2
;SELECT * FROM test1 WHERE f1==8 ORDER BY f1,f2;